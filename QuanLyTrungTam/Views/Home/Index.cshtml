

@{
    ViewBag.Title = "Báo cáo và biểu đồ";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/drilldown.js"></script>

<style>
    .highcharts-figure, .highcharts-data-table table {
        min-width: 360px;
        max-width: 1200px;
        margin: 1em auto;
        height: 600px;
    }

    .highcharts-data-table table {
        font-family: Verdana, sans-serif;
        border-collapse: collapse;
        border: 1px solid #EBEBEB;
        margin: 10px auto;
        text-align: center;
        width: 100%;
        max-width: 500px;
    }

    .highcharts-data-table caption {
        padding: 1em 0;
        font-size: 1.2em;
        color: #555;
    }

    .highcharts-data-table th {
        font-weight: 600;
        padding: 0.5em;
    }

    .highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
        padding: 0.5em;
    }

    .highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
        background: #f8f8f8;
    }

    .highcharts-data-table tr:hover {
        background: #f1f7ff;
    }
</style>

<div>
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">@ViewBag.Title</h1>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
        <div class="row">
            <div class="col-lg-3 col-md-6">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-3">
                                <i class="fa fa-users fa-5x"></i>
                            </div>
                            <div class="col-xs-9 text-right">
                                <div class="huge">@ViewBag.GiaoVien</div>
                                <div>Tổng giáo viên</div>
                            </div>
                        </div>
                    </div>
                    <a href="~/GiaoVien/Index">
                        <div class="panel-footer">
                            <span class="pull-left">Xem chi tiết</span>
                            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                            <div class="clearfix"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="panel panel-green">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-3">
                                <i class="fa  fa-users fa-5x"></i>
                            </div>
                            <div class="col-xs-9 text-right">
                                <div class="huge">@ViewBag.HocVien</div>
                                <div>Tổng học viên</div>
                            </div>
                        </div>
                    </div>
                    <a href="~/HocVien/Index">
                        <div class="panel-footer">
                            <span class="pull-left">Xem chi tiết</span>
                            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                            <div class="clearfix"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="panel panel-yellow">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-3">
                                <i class="fa fa-shopping-cart fa-5x"></i>
                            </div>
                            <div class="col-xs-9 text-right">
                                <div class="huge">@ViewBag.KhoaHoc</div>
                                <div>Tổng khóa học</div>
                            </div>
                        </div>
                    </div>
                    <a href="~/KhoaHoc/Index">
                        <div class="panel-footer">
                            <span class="pull-left">Xem chi tiết</span>
                            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                            <div class="clearfix"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="panel panel-red">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-3">
                                <i class="fa fa-dollar fa-5x"></i>
                            </div>
                            <div class="col-xs-9 text-right">
                                <div class="huge">@ViewBag.TongTien</div>
                                <div>Doanh thu ( VND )</div>
                            </div>
                        </div>
                    </div>
                    <a href="/HoaDon/Index">
                        <div class="panel-footer">
                            <span class="pull-left">Xem chi tiết</span>
                            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                            <div class="clearfix"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-3">
                                <i class="fa  fa-user fa-5x"></i>
                            </div>
                            <div class="col-xs-9 text-right">
                                <div class="huge">@ViewBag.HocVienDangKyMoi</div>
                                <div>Học viên mới hôm nay</div>
                            </div>
                        </div>
                    </div>
                    <a href="/HocVien/Index">
                        <div class="panel-footer">
                            <span class="pull-left">Xem chi tiết</span>
                            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                            <div class="clearfix"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="panel panel-green">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-3">
                                <i class="fa fa-user fa-5x"></i>
                            </div>
                            <div class="col-xs-9 text-right">
                                <div class="huge">@ViewBag.HocVienDangKyMoiTheoThang</div>
                                <div>Học viên mới theo tháng</div>
                            </div>
                        </div>
                    </div>
                    <a href="/HoaDon/Index">
                        <div class="panel-footer">
                            <span class="pull-left">Xem chi tiết</span>
                            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                            <div class="clearfix"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="panel panel-yellow">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-3">
                                <i class="fa fa-dollar fa-5x"></i>
                            </div>
                            <div class="col-xs-9 text-right">
                                <div class="huge">@ViewBag.TongTienLuong</div>
                                <div>Tổng tiền lương ( VND )</div>
                            </div>
                        </div>
                    </div>
                    <a href="/GiaoVien/Index">
                        <div class="panel-footer">
                            <span class="pull-left">Xem chi tiết</span>
                            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                            <div class="clearfix"></div>
                        </div>
                    </a>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="panel panel-red">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-3">
                                <i class="fa fa-check-circle fa-5x"></i>
                            </div>
                            <div class="col-xs-9 text-right">
                                <div class="huge">@ViewBag.TongLopHoc</div>
                                <div>Lớp học đang hoạt động</div>
                            </div>
                        </div>
                    </div>
                    <a href="/GiaoVien/Index">
                        <div class="panel-footer">
                            <span class="pull-left">Xem chi tiết</span>
                            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                            <div class="clearfix"></div>
                        </div>
                    </a>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Chart-->

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <figure class="highcharts-figure">
                <div id="hightchart"></div>
                <p class="highcharts-description">

                </p>
            </figure>
        </div>
    </div>
</div>



<div class="container">
    <div class="row">
        <div class="col-md-4">
            <figure class="highcharts-figure">
                <div id="piechart" style="width: 500px"></div>
                <p class="highcharts-description">
                    Có tổng số <span style="color:red">@ViewBag.GiaoVien</span> giáo viên
                </p>
            </figure>
        </div>
        <div class="col-md-8">

            <figure class="highcharts-figure">
                <div id="areachart"></div>
                <p class="highcharts-description">
                    Biểu đồ thể hiện số lượng học viên theo từng tháng
                </p>
            </figure>
        </div>
    </div>
</div>


<script>
    $(document).ready(function () {
        $.getJSON("/Home/GetData", function (data) {

            var totalMoney = []

            for (var i = 0; i < data.length; i++) {
                totalMoney.push(data[i].count);
            }

            Highcharts.chart('hightchart', {
                chart: {
                    type: 'line'
                },
                title: {
                    text: '<span style="color:red; font-size: 30px"> Biểu đồ doanh thu hàng tháng</span>'
                },
                subtitle: {
                    text: 'Nguồn : Trung Tâm Đan Thanh'
                },
                xAxis: {
                    categories: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', 'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12']
                },
                yAxis: {
                    title: {
                        text: 'VND ( Nghìn Đồng )'
                    }
                },
                plotOptions: {
                    line: {
                        dataLabels: {
                            enabled: true
                        },
                        enableMouseTracking: false
                    }
                },
                series: [{
                    name: 'Ẩn/Hiện',
                    data: totalMoney
                }]
            });
        })


        $.getJSON("/Home/GetDataHocVien", function (data) {

            var totalStudent = []

            for (var i = 0; i < data.length; i++) {
                totalStudent.push(data[i].count);
            }

            Highcharts.chart('areachart', {
                chart: {
                    type: 'area'
                },
                title: {
                    text: '<span style="color: red; font-size: 20px">Biểu đồ Học viên </span>'
                },
                xAxis: {
                    categories: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', 'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12']
                },
                credits: {
                    enabled: false
                },
                series: [{
                    name: 'Ẩn/Hiện',
                    data: totalStudent
                }]
            });

        })

        

        $.getJSON("/Home/GetDataPieChart", function (data) {
            Highcharts.chart('piechart', {
                chart: {
                    type: 'pie'
                },
                title: {
                    text: '<span style="color: red; font-size: 20px">Biểu đồ thống kê nhân viên</span>'
                },
                //subtitle: {
                //    text: 'Click the slices to view versions. Source: <a href="http://statcounter.com" target="_blank">statcounter.com</a>'
                //},

                accessibility: {
                    announceNewData: {
                        enabled: true
                    },
                    point: {
                        valueSuffix: '%'
                    }
                },

                plotOptions: {
                    series: {
                        dataLabels: {
                            enabled: true,
                            format: '{point.name}: {point.y:.1f} Nhân viên'
                        }
                    }
                },

                tooltip: {
                    headerFormat: '<span style="font-size:11px">{series.name}</span>< br >',
                    pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.0f} nhân viên</b>< br /> '
                },

                series: [
                    {
                        name: "Browsers",
                        colorByPoint: true,
                        data: [
                            {
                                name: "Nam",
                                y: data.Male
                            },
                            {
                                name: "Nữ",
                                y: data.Female
                            }
                        ]
                    }
                ]
            });
        });
    });


</script>





